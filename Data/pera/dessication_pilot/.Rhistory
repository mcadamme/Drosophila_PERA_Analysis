#HvCandidate gene data
x <- c("sciplot", "lme4", "effects","car", "survival")
lapply(x, FUN = function(X) {
do.call("require", list(X))
})
?points
install.packages("onemap")
require(onemap)
install.packages("onemap")
install.packages("tkrplot")
install.packages("tkrplot", dependencies = FALSE)
install.packages("onemap")
install.packages("onemap")
library(lattice)
library(grid)
Bt_only <- c(18,18,22,25,27,26,25,21,17,17,16,16,15,5)
stacked <- c(1,1,2,4,6,9,15,28,40,46,47,49,52,71)
year <- c(2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013)
sum(Bt_only,stacked)
summed <- tapply(Bt_only, stacked, sum)
summed
data <- cbind(Bt_only, stacked, year)
View(data)
data <- data.frame(cbind(Bt_only, stacked, year))
data <- data.frame(cbind(Bt_only, stacked))
View(data)
data$comb <- rowSums(data)
View(data)
data <- cbind(data, year)
View(data)
plot(data$year, data$comb)
Bt_only2 <- c(15,13,13,14,16,18,18,17,18,17,15,17,14,8)
stacked2 <- c(20,24,22,27,30,34,39,42,45,48,58,58,63,67)
data2 <- cbind(Bt_only2, stacked2)
data2 <- data.frame(cbind(Bt_only2, stacked2))
data$comb <- rowSums(data2)
View(data2)
View(data2)
data2$comb <- rowSums(data2)
data$comb <- rowSums(data)
corn <- cbind(data, year)
cotton <- cbind(data2, year)
View(cotton)
View(corn)
plot(corn$year, corn$comb)
View(corn)
library(lattice)
library(grid)
Bt_only <- c(18,18,22,25,27,26,25,21,17,17,16,16,15,5)
stacked <- c(1,1,2,4,6,9,15,28,40,46,47,49,52,71)
year <- c(2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013)
data <- data.frame(cbind(Bt_only, stacked))
data$comb <- rowSums(data)
corn <- data.frame(cbind(data, year))
Bt_only2 <- c(15,13,13,14,16,18,18,17,18,17,15,17,14,8)
stacked2 <- c(20,24,22,27,30,34,39,42,45,48,58,58,63,67)
data2 <- data.frame(cbind(Bt_only2, stacked2))
data2$comb <- rowSums(data2)
cotton <- data.frame(cbind(data2, year))
plot(corn$year, corn$comb)
points(cotton$year, cotton$comb)
?plot
plot(corn$year, corn$comb, xlab = "Year", ylab = "Percent of Total Planted", pch = 16, col = "blue")
points(cotton$year, cotton$comb, pch = 16, col = "red")
plot(corn$year, corn$comb, ylim = c(0,100), xlab = "Year", ylab = "Percent of Total Planted", pch = 16, col = "blue")
points(cotton$year, cotton$comb, pch = 16, col = "red")
#bt adoption in the us according to USDA ERS
#http://www.ers.usda.gov/data-products/adoption-of-genetically-engineered-crops-in-the-us.aspx#.UnwSdayp2Bs
library(lattice)
library(grid)
#percent of all corn planted
Bt_only <- c(18,18,22,25,27,26,25,21,17,17,16,16,15,5)
stacked <- c(1,1,2,4,6,9,15,28,40,46,47,49,52,71)
year <- c(2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013)
data <- data.frame(cbind(Bt_only, stacked))
data$comb <- rowSums(data)
corn <- data.frame(cbind(data, year))
Bt_only2 <- c(15,13,13,14,16,18,18,17,18,17,15,17,14,8)
stacked2 <- c(20,24,22,27,30,34,39,42,45,48,58,58,63,67)
data2 <- data.frame(cbind(Bt_only2, stacked2))
data2$comb <- rowSums(data2)
cotton <- data.frame(cbind(data2, year))
plot(corn$year, corn$comb, ylim = c(0,100), xlab = "Year", ylab = "Percent Planted Acreage", pch = 16, col = "blue")
points(cotton$year, cotton$comb, pch = 16, col = "red")
?plot
plot(corn$year, corn$comb, type = l, ylim = c(0,100), xlab = "Year", ylab = "Percent Planted Acreage", col = "blue")
plot(corn$year, corn$comb, type = "l", ylim = c(0,100), xlab = "Year", ylab = "Percent Planted Acreage", col = "blue")
points(cotton$year, cotton$comb, type = "l", col = "red")
plot(corn$year, corn$comb, type = "l", lwd = 2, ylim = c(0,100), xlab = "Year", ylab = "Percent Planted Acreage", col = "blue")
points(cotton$year, cotton$comb, type = "l", lwd = 2, col = "red")
tbw <- c(14390,12526,4135,4450,1344,1529,3659,1305,1664,3554,1283,588)
plot(year, tbw, type = "p", pch = 16, cex = 2, col = black, ylim = c(0,15000), xlab = "Year", ylab = "TBW Trap Catch" )
year2 <- c(2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011)
plot(year2, tbw, type = "p", pch = 16, cex = 2, col = black, ylim = c(0,15000), xlab = "Year", ylab = "TBW Trap Catch" )
plot(year2, tbw, type = "p", pch = 16, cex = 2, col = "black", ylim = c(0,15000), xlab = "Year", ylab = "TBW Trap Catch" )
plot(year2, tbw, type = "p", pch = 16, cex = 1.2, col = "black", ylim = c(0,15000), xlab = "Year", ylab = "TBW Trap Catch" )
?plot
year2 <- c(1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011)
tbw <- c(14753,18684,15081,10184,5721,20179,18895,8518,4893,5542,5054,5695,5230,6171,14390,12526,4135,4450,1344,1529,3659,1305,1664,3554,1283,588)
cbw <- c(52853,22492,42327,32472,24313,27778,10269,11646,23946,23687,63813,18533,29043,25535,19254,33323,41998,23728,15465,48198,23728,15465,48198,34105,195347,44463,68090,45363,32960)
plot(year2, tbw, type = "h", pch = 16, cex = 1.2, col = "blue", ylim = c(0,15000), xlab = "Year", ylab = "TBW Trap Catch" )
plot(year2, tbw, type = "h", pch = 16, cex = 1.2, col = "blue", ylim = c(0,50000), xlab = "Year", ylab = "TBW Trap Catch" )
plot(year2, tbw, type = "h", lwd = 10, cex = 1.2, col = "blue", ylim = c(0,50000), xlab = "Year", ylab = "TBW Trap Catch" )
plot(year2, tbw, type = "h", lwd = 8, cex = 1.2, col = "blue", ylim = c(0,50000), xlab = "Year", ylab = "TBW Trap Catch" )
plot(year2, cbw, type = "h", lwd = 8, cex = 1.2, col = "orange", ylim = c(0,50000), xlab = "Year", ylab = "CBW Trap Catch")
cbw <- c(52853,22492,42327,32472,24313,27778,10269,11646,23946,23687,63813,18533,29043,25535,19254,33323,41998,23728,15465,48198,34105,195347,44463,68090,45363,32960)
plot(year2, cbw, type = "h", lwd = 8, cex = 1.2, col = "orange", ylim = c(0,50000), xlab = "Year", ylab = "CBW Trap Catch")
plot(year2, tbw, type = "h", lwd = 8, cex = 1.2, col = "blue", ylim = c(0,60000), xlab = "Year", ylab = "TBW Trap Catch" )
plot(year2, cbw, type = "h", lwd = 8, cex = 1.2, col = "orange", ylim = c(0,60000), xlab = "Year", ylab = "CBW Trap Catch")
plot(year2, tbw, type = "h", lwd = 8, cex = 1.2, col = "blue", ylim = c(0,30000), xlab = "Year", ylab = "TBW Trap Catch" )
plot(year2, cbw, type = "h", lwd = 8, cex = 1.2, col = "orange", ylim = c(0,70000), xlab = "Year", ylab = "CBW Trap Catch")
plot(year2, tbw, type = "h", lwd = 8, cex = 1.2, col = "blue", ylim = c(0,30000), xlab = "Year", ylab = "TBW Trap Catch" )
plot(year2, cbw, type = "h", lwd = 8, cex = 1.2, col = "orange", ylim = c(0,75000), xlab = "Year", ylab = "CBW Trap Catch")
cbw <- c(52853,22492,42327,32472,24313,27778,10269,11646,23946,23687,63813,18533,29043,25535,19254,33323,41998,23728,15465,48198,34105,19547,44463,68090,45363,32960)
plot(year2, cbw, type = "h", lwd = 8, cex = 1.2, col = "orange", ylim = c(0,75000), xlab = "Year", ylab = "CBW Trap Catch")
?plot
?tiff
plot.new()
png(file = "tbw_trap_catch.png", width = 600, length = 900, unit = "px")
plot(year2, tbw, type = "h", lwd = 8, cex = 1.2, col = "blue", ylim = c(0,30000), xlab = "Year", ylab = "TBW Trap Catch" )
dev.off()
plot.new()
png(file = "tbw_trap_catch.png", width = 600, height = 400, unit = "px")
plot(year2, tbw, type = "h", lwd = 8, cex = 1.2, col = "blue", ylim = c(0,30000), xlab = "Year", ylab = "TBW Trap Catch" )
dev.off()
plot.new()
png(file = "tbw_trap_catch.png", width = 600, height = 400, unit = "px")
plot(year2, tbw, type = "h", lwd = 10, cex.lab = 1.5, cex = 2, col = "blue", ylim = c(0,30000), xlab = "Year", ylab = "TBW Trap Catch" )
dev.off()
plot.new()
png(file = "tbw_trap_catch.png", width = 800, height = 600, unit = "px")
plot(year2, tbw, type = "h", lwd = 10, cex.lab = 2, cex = 3, col = "blue", ylim = c(0,30000), xlab = "Year", ylab = "TBW Trap Catch" )
dev.off()
plot.new()
png(file = "tbw_trap_catch.png", width = 800, height = 600, unit = "px")
plot(year2, tbw, type = "h", lwd = 10, cex.lab = 4, cex = 4, col = "blue", ylim = c(0,30000), xlab = "Year", ylab = "TBW Trap Catch" )
dev.off()
plot.new()
png(file = "tbw_trap_catch.png", width = 600, height = 400, unit = "px")
plot(year2, tbw, type = "h", lwd = 10, cex.lab = 2, cex = 3, col = "blue", ylim = c(0,30000), xlab = "Year", ylab = "TBW Trap Catch" )
dev.off()
?plot
plot.new()
png(file = "tbw_trap_catch.png", width = 600, height = 400, unit = "px")
plot(year2, tbw, type = "h", lwd = 10, cex.axis = 3, cex = 3, col = "blue", ylim = c(0,30000), xlab = "Year", ylab = "TBW Trap Catch" )
dev.off()
plot.new()
png(file = "tbw_trap_catch.png", width = 600, height = 400, unit = "px")
plot(year2, tbw, type = "h", lwd = 10, cex.axis = 2, cex = 3, col = "blue", ylim = c(0,30000), xlab = "Year", ylab = "TBW Trap Catch" )
dev.off()
?par
plot.new()
png(file = "tbw_trap_catch.png", width = 600, height = 400, unit = "px")
plot(year2, tbw, type = "h", lwd = 10, cex.axis = 1.5, cex = 3, col = "blue", ylim = c(0,30000), xlab = "Year", ylab = "TBW Trap Catch" )
dev.off()
plot.new()
png(file = "tbw_trap_catch.png", width = 600, height = 400, unit = "px")
plot(year2, tbw, type = "h", lwd = 10, cex.axis = 1.5, cex = 3, col = "blue", ylim = c(0,30000), xlab = "Year", ylab = "" )
dev.off()
plot.new()
png(file = "tbw_trap_catch.png", width = 600, height = 400, unit = "px")
plot(year2, tbw, type = "h", lwd = 10, cex.axis = 1.5, cex = 3, col = "blue", ylim = c(0,30000), xlab = "", ylab = "" )
dev.off()
plot.new()
png(file = "tbw_trap_catch.png", width = 900, height = 600, unit = "px")
plot(year2, tbw, type = "h", lwd = 10, cex.axis = 2.5, cex = 3, col = "blue", ylim = c(0,30000), xlab = "", ylab = "" )
dev.off()
?par
plot.new()
png(file = "tbw_trap_catch.png", width = 600, height = 400, unit = "px")
plot(year2, tbw, type = "h", lwd = 10, cex.axis = 2, cex = 3, col = "blue", yliplot(year2, tbw, type = "h", lwd = 10, cex.axis = 1.5, cex = 2, col = "blue", ylim = c(0,30000), xlab = "", ylab = "" )m = c(0,30000), xlab = "Year", ylab = "TBW Trap Catch" )
dev.off()
plot(year2, tbw, type = "h", lwd = 10, cex.axis = 1.5, cex = 2, col = "blue", ylim = c(0,30000), xlab = "Year", ylab = "TBW Trap Catch")
plot(year2, tbw, type = "h", lwd = 10, cex.axis = 1.5, cex.lab = 2, col = "blue", ylim = c(0,30000), xlab = "Year", ylab = "TBW Trap Catch")
plot(year2, tbw, type = "h", lwd = 10, cex.axis = 1.5, cex.lab = 1.8, col = "blue", ylim = c(0,30000), xlab = "Year", ylab = "TBW Trap Catch")
plot(year2, tbw, type = "h", lwd = 10, cex.axis = 1.5, cex.lab = 1.8, col = "blue", ylim = c(0,30000))
plot(year2, cbw, type = "h", lwd = 8, cex.axis = 1.5, cex.lab = 1.8, col = "orange", ylim = c(0,75000), xlab = "Year", ylab = "CBW Trap Catch")
?rand
??rand
#This is a script to look at the differences in response between flies run
#with a wet flug vs. just agarose during their 24 h starvation.
setwd("~/Dropbox/Megan/Drosophila_work/PERA_data/dessication_pilot")
x <- c("lattice", "grid", "plyr", "data.table")
lapply(x, FUN = function(X) {
do.call("require", list(X))
})
dessic_pilot <- read.table("PERA_dessic_pilot.txt", header = T)
dessic_pilot[21:22, "avg_h2o"] <- NA
dessic_pilot[22:23, "avg_sugar"] <- NA
dessic_pilot[23:24, "avg_salt"] <- NA
dessic_pilot <- transform(dessic_pilot, avg_h2o = rowMeans(dessic_pilot[, c(5, 11, 17)], na.rm = TRUE))
dessic_pilot <- transform(dessic_pilot, avg_sugar = rowMeans(dessic_pilot[, c(7,13)], na.rm = TRUE))
dessic_pilot <- transform(dessic_pilot, avg_salt = rowMeans(dessic_pilot[, c(9,15)], na.rm = TRUE))
dessic_pilot <- data.frame(dessic_pilot)
dessic_pilot_h2o <- dessic_pilot[, c(1,2,3,4,5,11,17,19,20)]
# reshaping into long format
dp_reshaped <- reshape(dessic_pilot_h2o,
varying = list(4:5),
direction="long",
idvar="subject",
v.names="PER")
View(dp_reshaped)
# reshaping into long format
dp_reshaped <- reshape(dessic_pilot_h2o,
varying = list(5:7),
direction="long",
idvar="subject",
v.names="PER")
View(dp_reshaped)
dp_reshaped<- dp_reshaped[order(dp_reshaped$subject),]
head(dp_reshaped)
head(dessic_pilot_h2o)
tail(dp_reshaped)
tail(dessic_pilot_h2o)
dp_reshaped$time <- as.factor(dp_reshaped$time) # only 2 "levels": first and second, so treat as factor.
model_trial_1 <- glm(PER ~ Geno*Sex + Date + Sugar_before_salt + Wetted_Flug + time,
data=dp_reshaped, family=binomial, x=T)
model_trial_1 <- glm(PER ~ Geno*Sex + Date + Sucrose_before_salt + Wetted_Flug + time,
data=dp_reshaped, family=binomial, x=T)
x <- c("lattice", "grid", "plyr", "data.table", "car")
lapply(x, FUN = function(X) {
do.call("require", list(X))
})
summary(model_trial_1)
anova(model_trial_1, test="LRT")
car::Anova(model_trial_1, test.statistic="LR", type=2)
car::Anova(model_trial_1, test.statistic="LR", type=3)
model_trial_1 <- glm(PER ~ Geno*Sex*Wetted_Flug + Date + Sucrose_before_salt + time,
data=dp_reshaped, family=binomial, x=T)
summary(model_trial_1)
anova(model_trial_1, test="LRT")
car::Anova(model_trial_1, test.statistic="LR", type=2)
car::Anova(model_trial_1, test.statistic="LR", type=3)
model_trial_1 <- glm(PER ~ Geno*Sex*Wetted_Flug + time,
data=dp_reshaped, family=binomial, x=T)
summary(model_trial_1)
anova(model_trial_1, test="LRT")
car::Anova(model_trial_1, test.statistic="LR", type=2)
library(lme4)
model_trial_2 <- glmer(PER ~ Geno*Sex*Wetted_Flug + time + (1 + time|subject), data=dp_reshaped, family=binomial)
model_trial_2
head(dessic_pilot)
# reshaping into long format
dpsug_reshaped <- reshape(dessic_pilot_sug,
varying = list(5:6),
direction="long",
idvar="subject",
v.names="PER")
dessic_pilot_sug <- dessic_pilot[, c(1,2,3,4,7,13,19,20)]
# reshaping into long format
dpsug_reshaped <- reshape(dessic_pilot_sug,
varying = list(5:6),
direction="long",
idvar="subject",
v.names="PER")
dpsug_reshaped<- dpsug_reshaped[order(dpsug_reshaped$subject),]
# check that reshaped produced appropriate data set
head(dpsug_reshaped)
head(dessic_pilot_sug)
tail(dpsug_reshaped)
tail(dessic_pilot_sug)
dpsug_reshaped$time <- as.factor(dpsug_reshaped$time) # only 2 "levels": first and second, so treat as factor.
model_trial_1 <- glm(PER ~ Geno*Sex*Wetted_Flug + time,
data=dpsug_reshaped, family=binomial, x=T)
summary(model_trial_1)
anova(model_trial_1, test="LRT")
car::Anova(model_trial_1, test.statistic="LR", type=2)
#now reformatting for a quick look at salt responses
dessic_pilot_kcl <- dessic_pilot[, c(1,2,3,4,9,15,19,20)]
# reshaping into long format
dpsug_reshaped <- reshape(dessic_pilot_kcl,
varying = list(5:6),
direction="long",
idvar="subject",
v.names="PER")
# sorting data by subject
dpkcl_reshaped<- dpkcl_reshaped[order(dpkcl_reshaped$subject),]
# check that reshaped produced appropriate data set
head(dpkcl_reshaped)
head(dessic_pilot_kcl)
tail(dpkcl_reshaped)
tail(dessic_pilot_kcl)
dpkcl_reshaped$time <- as.factor(dpkcl_reshaped$time) # only 2 "levels": first and second, so treat as factor.
model_trial_1 <- glm(PER ~ Geno*Sex*Wetted_Flug + time,
data=dpkcl_reshaped, family=binomial, x=T)
summary(model_trial_1)
anova(model_trial_1, test="LRT")
car::Anova(model_trial_1, test.statistic="LR", type=2)
#now reformatting for a quick look at salt responses
dessic_pilot_kcl <- dessic_pilot[, c(1,2,3,4,9,15,19,20)]
# reshaping into long format
dpkcl_reshaped <- reshape(dessic_pilot_kcl,
varying = list(5:6),
direction="long",
idvar="subject",
v.names="PER")
# sorting data by subject
dpkcl_reshaped<- dpkcl_reshaped[order(dpkcl_reshaped$subject),]
# check that reshaped produced appropriate data set
head(dpkcl_reshaped)
head(dessic_pilot_kcl)
tail(dpkcl_reshaped)
tail(dessic_pilot_kcl)
dpkcl_reshaped$time <- as.factor(dpkcl_reshaped$time) # only 2 "levels": first and second, so treat as factor.
model_trial_1 <- glm(PER ~ Geno*Sex*Wetted_Flug + time,
data=dpkcl_reshaped, family=binomial, x=T)
summary(model_trial_1)
anova(model_trial_1, test="LRT")
car::Anova(model_trial_1, test.statistic="LR", type=2)
plogis(-1.962e-08)
?plogis
?glm
plogis((-.1752+-1.962e-08))
plogis(-.1752)
plogis(-0.00000001962)
plogis ((-17.52 + -0.00000001962))
plogis((-17.52 + -0.00000001962))
plogis(-17.52)
exp(cbind(OR = coef(model_trial_1), confint(model_trial_1))
)
warnings()
